var open=document.querySelector(".btn-message"),popup=document.querySelector(".popup-window"),close=popup.querySelector(".message-close"),form=popup.querySelector("form"),user_name=document.querySelector("#name-field"),email=popup.querySelector("#email-field"),text=popup.querySelector("#message-field"),isStorageSupport=!0,user_name_storage="",email_storage="",text_storage="";try{user_name_storage=localStorage.getItem("user_name"),email_storage=localStorage.getItem("email"),text_storage=localStorage.getItem("text")}catch(e){isStorageSupport=!1}open.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("popup-window-show"),(user_name_storage||email_storage)&&(user_name.value=user_name_storage,email.value=email_storage),user_name_storage?text.focus():user_name.focus()}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("popup-window-show"),popup.classList.remove("shake-error")}),user_name.addEventListener("click",function(e){e.preventDefault(),user_name.classList.remove("warning")}),email.addEventListener("click",function(e){e.preventDefault(),email.classList.remove("warning")}),text.addEventListener("click",function(e){e.preventDefault(),text.classList.remove("warning")}),form.addEventListener("submit",function(e){user_name.value||(e.preventDefault(),user_name.classList.add("warning"),popup.classList.remove("shake-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("shake-error"),console.log(user_name.classList),console.log("Нужно ввести логин и пароль")),email.value||(e.preventDefault(),email.classList.add("warning"),popup.classList.remove("shake-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("shake-error"),console.log(user_name.classList),console.log("Нужно ввести логин и пароль")),text.value?isStorageSupport&&(localStorage.setItem("user_name",user_name.value),localStorage.setItem("email",email.value)):(e.preventDefault(),text.classList.add("warning"),popup.classList.remove("shake-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("shake-error"),console.log(user_name.classList),console.log("Нужно ввести логин и пароль"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),popup.classList.contains("popup-window-show")&&popup.classList.remove("popup-window-show"),popup.classList.remove("shake-error"))});
